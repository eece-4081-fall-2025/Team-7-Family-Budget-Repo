{% extends "budget/base.html" %}

{% block title %}Spending Categories{% endblock %}

{% block content %}
<h1>Spending Categories</h1>

{% if group %}
  <p>Managing categories for: <strong>{{ group.name }}</strong></p>
{% else %}
  <p>You are not currently in a family group.</p>
{% endif %}

<div class="category-list">
  {% if categories %}
    {% for cat in categories %}
      <div class="category-item" style="padding: 6px 0; border-bottom: 1px solid #eee;">
        <strong>{{ cat.name }}</strong>
        {% if cat.budget_limit %}
          – Limit: ${{ cat.budget_limit }}
        {% else %}
          – No limit set
        {% endif %}

        <!-- Form to update budget limit -->
        <form method="post" style="display:inline;">
          {% csrf_token %}
          <input type="hidden" name="category_id" value="{{ cat.id }}">
          <input type="text" name="limit" placeholder="e.g. 500.00" style="width:100px;">
          <button type="submit">Set Limit</button>
        </form>

        <!-- Form to delete this category -->
        <form method="post" style="display:inline; margin-left: 8px;">
          {% csrf_token %}
          <input type="hidden" name="delete_category_id" value="{{ cat.id }}">
          <button type="submit">Delete</button>
        </form>
      </div>
    {% endfor %}
  {% else %}
    <p>No categories yet.</p>
  {% endif %}
</div>

<hr>

<form method="post">
  {% csrf_token %}
  <label for="id_name"><strong>Add New Category</strong></label>
  <input type="text" id="id_name" name="name" placeholder="e.g. Groceries" style="width:100%; max-width:300px;">
  <button type="submit">Add Category</button>
</form>

{% endblock %}
